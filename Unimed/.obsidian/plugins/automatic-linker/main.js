/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
if you want to view the source, please visit the github repository of this plugin
*/

var ge=Object.create;var N=Object.defineProperty;var he=Object.getOwnPropertyDescriptor;var de=Object.getOwnPropertyNames;var pe=Object.getPrototypeOf,fe=Object.prototype.hasOwnProperty;var j=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports),me=(e,t)=>{for(var n in t)N(e,n,{get:t[n],enumerable:!0})},q=(e,t,n,i)=>{if(t&&typeof t=="object"||typeof t=="function")for(let a of de(t))!fe.call(e,a)&&a!==n&&N(e,a,{get:()=>t[a],enumerable:!(i=he(t,a))||i.enumerable});return e};var we=(e,t,n)=>(n=e!=null?ge(pe(e)):{},q(t||!e||!e.__esModule?N(n,"default",{value:e,enumerable:!0}):n,e)),Le=e=>q(N({},"__esModule",{value:!0}),e);var X=j((je,J)=>{"use strict";var v=function(e){if(e=e||{},this.Promise=e.Promise||Promise,this.queues=Object.create(null),this.domainReentrant=e.domainReentrant||!1,this.domainReentrant){if(typeof process>"u"||typeof process.domain>"u")throw new Error("Domain-reentrant locks require `process.domain` to exist. Please flip `opts.domainReentrant = false`, use a NodeJS version that still implements Domain, or install a browser polyfill.");this.domains=Object.create(null)}this.timeout=e.timeout||v.DEFAULT_TIMEOUT,this.maxOccupationTime=e.maxOccupationTime||v.DEFAULT_MAX_OCCUPATION_TIME,this.maxExecutionTime=e.maxExecutionTime||v.DEFAULT_MAX_EXECUTION_TIME,e.maxPending===1/0||Number.isInteger(e.maxPending)&&e.maxPending>=0?this.maxPending=e.maxPending:this.maxPending=v.DEFAULT_MAX_PENDING};v.DEFAULT_TIMEOUT=0;v.DEFAULT_MAX_OCCUPATION_TIME=0;v.DEFAULT_MAX_EXECUTION_TIME=0;v.DEFAULT_MAX_PENDING=1e3;v.prototype.acquire=function(e,t,n,i){if(Array.isArray(e))return this._acquireBatch(e,t,n,i);if(typeof t!="function")throw new Error("You must pass a function to execute");var a=null,u=null,r=null;typeof n!="function"&&(i=n,n=null,r=new this.Promise(function(C,L){a=C,u=L})),i=i||{};var o=!1,s=null,h=null,c=null,l=this,d=function(C,L,R){h&&(clearTimeout(h),h=null),c&&(clearTimeout(c),c=null),C&&(l.queues[e]&&l.queues[e].length===0&&delete l.queues[e],l.domainReentrant&&delete l.domains[e]),o||(r?L?u(L):a(R):typeof n=="function"&&n(L,R),o=!0),C&&l.queues[e]&&l.queues[e].length>0&&l.queues[e].shift()()},g=function(C){if(o)return d(C);s&&(clearTimeout(s),s=null),l.domainReentrant&&C&&(l.domains[e]=process.domain);var L=i.maxExecutionTime||l.maxExecutionTime;if(L&&(c=setTimeout(function(){l.queues[e]&&d(C,new Error("Maximum execution time is exceeded "+e))},L)),t.length===1){var R=!1;try{t(function(b,A){R||(R=!0,d(C,b,A))})}catch(b){R||(R=!0,d(C,b))}}else l._promiseTry(function(){return t()}).then(function(b){d(C,void 0,b)},function(b){d(C,b)})};l.domainReentrant&&process.domain&&(g=process.domain.bind(g));var f=i.maxPending||l.maxPending;if(!l.queues[e])l.queues[e]=[],g(!0);else if(l.domainReentrant&&process.domain&&process.domain===l.domains[e])g(!1);else if(l.queues[e].length>=f)d(!1,new Error("Too many pending tasks in queue "+e));else{var p=function(){g(!0)};i.skipQueue?l.queues[e].unshift(p):l.queues[e].push(p);var m=i.timeout||l.timeout;m&&(s=setTimeout(function(){s=null,d(!1,new Error("async-lock timed out in queue "+e))},m))}var U=i.maxOccupationTime||l.maxOccupationTime;if(U&&(h=setTimeout(function(){l.queues[e]&&d(!1,new Error("Maximum occupation time is exceeded in queue "+e))},U)),r)return r};v.prototype._acquireBatch=function(e,t,n,i){typeof n!="function"&&(i=n,n=null);var a=this,u=function(o,s){return function(h){a.acquire(o,s,h,i)}},r=e.reduceRight(function(o,s){return u(s,o)},t);if(typeof n=="function")r(n);else return new this.Promise(function(o,s){r.length===1?r(function(h,c){h?s(h):o(c)}):o(r())})};v.prototype.isBusy=function(e){return e?!!this.queues[e]:Object.keys(this.queues).length>0};v.prototype._promiseTry=function(e){try{return this.Promise.resolve(e())}catch(t){return this.Promise.reject(t)}};J.exports=v});var K=j((qe,V)=>{"use strict";V.exports=X()});var _e={};me(_e,{default:()=>P});module.exports=Le(_e);var ce=we(K());var z=be;function be(e,t,n){var i=null,a=null,u=n&&n.leading,r=n&&n.trailing;u==null&&(u=!0),r==null&&(r=!u),u==!0&&(r=!1);var o=function(){i&&(clearTimeout(i),i=null)},s=function(){var c=a;o(),c&&c()},h=function(){var c=u&&!i,l=this,d=arguments;if(a=function(){return e.apply(l,d)},i||(i=setTimeout(function(){if(i=null,r)return a()},t)),c)return c=!1,a()};return h.cancel=o,h.flush=s,h}var T=require("obsidian");var Q=e=>{let t=[],n=0,i=/`([^`]+)`/g,a;for(;(a=i.exec(e))!==null;)a.index>n&&t.push({isCode:!1,content:e.substring(n,a.index)}),t.push({isCode:!0,content:a[0]}),n=a.index+a[0].length;n<e.length&&t.push({isCode:!1,content:e.substring(n)});let u=/\[\[(.*?)(?:\|(.*?))?\]\]/g;return t.map(o=>o.isCode?o.content:o.content.replace(u,(s,h,c)=>c||h)).join("")};var Y={},x=(e,t)=>{let n=t+"/";return t&&e.startsWith(n)?e.slice(n.length).split("/")[0]||"":e.split("/")[0]||""},Z=(e,t=!1)=>{let n={children:new Map};for(let i of e){let a=n,u=t?i.toLowerCase():i;for(let r of u){let o=a.children.get(r);o||(o={children:new Map},a.children.set(r,o)),a=o}a.candidate=i}return n},F=(e,t,n=!1)=>{let i=e.map(s=>{let h={full:s.path,short:null,restrictNamespace:s.restrictNamespace,namespace:x(s.path,t)};if(t){let c=`${t}/`;s.path.startsWith(c)&&(h.short=s.path.slice(c.length))}return h}),a=new Map;for(let{full:s,short:h,restrictNamespace:c,namespace:l}of i){a.set(s,{canonical:s,restrictNamespace:c,namespace:l});let d=s.lastIndexOf("/");if(d!==-1){let g=s.slice(d+1);(n||/^[\p{Script=Han}\p{Script=Hiragana}\p{Script=Katakana}\p{Script=Hangul}]+$/u.test(g))&&(a.set(g,{canonical:s,restrictNamespace:c,namespace:l}),n&&a.set(g.toLowerCase(),{canonical:s,restrictNamespace:c,namespace:l}))}h&&a.set(h,{canonical:s,restrictNamespace:c,namespace:l})}for(let s of e)if(s.aliases){let h=null;if(t){let c=`${t}/`;s.path.startsWith(c)&&(h=s.path.slice(c.length))}for(let c of s.aliases){let l=h&&c===h?c:`${s.path}|${c}`;a.has(c)||a.set(c,{canonical:l,restrictNamespace:s.restrictNamespace,namespace:x(s.path,t)})}}let u=Array.from(a.keys()).sort((s,h)=>h.length-s.length),r=n?u.flatMap(s=>{let h=s.split("/"),c=h[h.length-1];return[s,c.toLowerCase()]}):u,o=Z(r,n);return{candidateMap:a,trie:o}};if(Y.vitest){let{it:e,expect:t,describe:n}=Y.vitest;n("getEffectiveNamespace",()=>{e("should return the first directory after the baseDir",()=>{t(x("pages/docs/file","pages")).toBe("docs"),t(x("pages/home/readme","pages")).toBe("home")}),e("should return the first segment if baseDir is not found",()=>{t(x("docs/file")).toBe("docs"),t(x("home/readme")).toBe("home")})}),n("buildTrie",()=>{e("should build a Trie with the given words",()=>{let a=Z(["hello","world","hi"]);t(a.children.has("h")).toBe(!0),t(a.children.has("w")).toBe(!0),t(a.children.get("h")?.children.has("e")).toBe(!0),t(a.children.get("h")?.children.get("i")?.candidate).toBe("hi")})}),n("buildCandidateTrie",()=>{e("should build a candidate map and trie",()=>{let i=[{path:"pages/docs/readme",restrictNamespace:!1,aliases:["intro"]},{path:"pages/home/index",restrictNamespace:!1,aliases:[]}],{candidateMap:a,trie:u}=F(i,"pages");t(a.has("pages/docs/readme")).toBe(!0),t(a.has("docs/readme")).toBe(!0),t(a.get("intro")?.canonical).toBe("pages/docs/readme|intro"),t(u.children.has("d")).toBe(!0),t(u.children.has("h")).toBe(!0)})})}var Ce=/(```[\s\S]*?```|`[^`]*`|\[\[[^\]]+\]\]|\[[^\]]+\]\([^)]+\)|https?:\/\/[^\s]+)/g,ee=/^\d{4}-\d{2}-\d{2}$/,Re=/^[0-9]{1,2}$/,ae=/[\p{Script=Han}\p{Script=Hiragana}\p{Script=Katakana}]/u,te=/^[\p{Script=Han}\p{Script=Hiragana}\p{Script=Katakana}\p{Script=Hangul}\s\d]+$/u,ne=/^[\p{Script=Hangul}]+$/u,Te=/^[\p{Script=Han}\p{Script=Hiragana}\p{Script=Katakana}\s\d]+$/u,ve=/^(https?:\/\/[^\s]+)/,S=e=>e===void 0||ae.test(e)?!0:!/[\p{L}\p{N}_/-]/u.test(e)||/[\t\n\r ]/.test(e),ie=e=>Re.test(e)&&parseInt(e,10)>=1&&parseInt(e,10)<=12,Ue=e=>/^\s*(\[\[[^\]]+\]\]|\[[^\]]+\]\([^)]+\))\s*$/.test(e),re=(e,t)=>{let n=new Map;for(let[i,a]of e.entries()){let u=i.lastIndexOf("/");if(u===-1)continue;let r=i.slice(u+1),o=t?r.toLowerCase():r,s=n.get(o);s||(s=[],n.set(o,s)),s.push([i,a])}return n},ke=(e,t)=>t?x(e,t):e.split("/")[0]||"",O=(e,t)=>(t&&(e.startsWith("pages/")&&(e=e.slice(6)),e.startsWith(t+"/")&&(e=e.slice((t+"/").length))),e),B=e=>{let t=e.includes("|"),n=e,i="";return t&&([n,i]=e.split("|")),{linkPath:n,alias:i,hasAlias:t}};function De(e){let t=e.trim();return!t||!t.includes("|")?!1:t.startsWith("|")&&t.endsWith("|")&&/^[|:\s-]+$/.test(t)?!0:t.startsWith("|")&&t.endsWith("|")}function se(e,t){let n=e.split(`
`),i=0;for(let a of n){let u=i,r=i+a.length;if(t>=u&&t<=r)return De(a);i+=a.length+1}return!1}var ye=(e,t,n,i,a,u={})=>oe(e,t,n,re(n,u.ignoreCase),a,i,u),xe=(e,t,n,i,a={})=>{let u=e.slice(t+n.length),r=u.match(/^(이다\.?)/);if(r){let{linkPath:o,alias:s,hasAlias:h}=B(i.canonical),c=O(o,a.baseDir),l="";if(h)l=`[[${c}|${s}]]`+r[0];else if(c.includes("/")){let d=c.split("/"),g=d[d.length-1];l=`[[${c}|${g}]]`+r[0]}else l=`[[${c}]]`+r[0];return{result:l,newIndex:t+n.length+r[0].length}}return u.match(/^(는|은)/)?{result:e[t],newIndex:t+1}:null},Ae=(e,t,n={})=>{let i=null,a=-1,u=t.includes("/")?t.slice(0,t.lastIndexOf("/")):"",r=u?u.split("/"):[];for(let[o,s]of e){let h=o.lastIndexOf("/"),l=o.slice(0,h).split("/"),d=0;for(let g=0;g<Math.min(l.length,r.length)&&l[g]===r[g];g++)d++;if(d>a)a=d,i=[o,s];else if(d===a&&i!==null)if(u===""&&n.baseDir){let g=n.baseDir+"/",f=U=>U.startsWith(g)?U.slice(g.length).split("/").length-1:1/0,p=f(o),m=f(i[0]);(p<m||p===m&&o.length<i[0].length)&&(i=[o,s])}else{let f=i[0].slice(0,i[0].lastIndexOf("/")).split("/");(l.length<f.length||l.length===f.length&&o.length<i[0].length)&&(i=[o,s])}}return i},oe=(e,t,n,i,a,u,r={})=>{let o="",s=0;e:for(;s<e.length;){let h=e.slice(s).match(ve);if(h){o+=h[0],s+=h[0].length;continue}let c=t,l=null,d=s;for(;d<e.length;){let g=r.ignoreCase?e[d].toLowerCase():e[d],f=c.children.get(g);if(!f)break;if(c=f,c.candidate){let p=e.substring(s,d+1);(te.test(p)||S(e[d+1]))&&(l={candidate:c.candidate,length:d-s+1})}d++}if(l){let g=e.substring(s,s+l.length);if(r.ignoreDateFormats&&ee.test(g)){o+=g,s+=l.length;continue e}if(ie(g)){o+=g,s+=l.length;continue}let f=l.candidate,p=n.get(f),m=e.substring(s,s+l.length);if(p){if(ne.test(g)){let y=xe(e,s,g,p,r);if(y){o+=y.result,s=y.newIndex;continue e}}if(!te.test(g)){let y=s>0?e[s-1]:void 0,ue=s+g.length<e.length?e[s+g.length]:void 0;if(!S(y)||!S(ue)){o+=e[s],s++;continue e}}if(Te.test(g)&&!ne.test(g)&&(s+g.length<e.length?e.slice(s+g.length,s+g.length+10):"").match(/^(が|は|を|に|で|と|から|まで|より|へ|の|や|で|も)/),r.namespaceResolution&&p.restrictNamespace&&p.namespace!==u){o+=g,s+=g.length;continue e}let{linkPath:R,alias:b,hasAlias:A}=B(p.canonical),D=O(R,r.baseDir),k;if(A)k=`${D}|${b}`;else if(D.includes("/")){let y=r.ignoreCase?m:D.split("/").pop()||m;k=`${D}|${y}`}else r.ignoreCase?m.toLowerCase()===D.toLowerCase()?k=m:k=`${D}|${m}`:m!==D?k=`${D}|${m}`:k=D;se(e,s)&&k.includes("|")&&(k=k.replace(/\|/g,"\\|")),o+=`[[${k}]]`,s+=g.length;continue e}}if(r.namespaceResolution){let g=null;for(let f=s;f<e.length;f++){let p=e.substring(s,f+1),m=r.ignoreCase?p.toLowerCase():p,U=e[f+1];if(!S(U)&&!i.has(m))continue;let C=i.get(m);if(C){let L=e[s-1];if(!S(L))break;if(r.ignoreDateFormats&&ee.test(p)||ie(p))continue;g={word:p,length:p.length,key:m,candidateList:C}}else if(g&&f>s+g.length-1)break}if(g){let f=g.candidateList.filter(([,m])=>!(m.restrictNamespace&&m.namespace!==u)),p=null;if(f.length===1)p=f[0][1];else if(f.length>1){let m=Ae(f,a,r);m&&(p=m[1])}if(p){let{linkPath:m,alias:U,hasAlias:C}=B(p.canonical),L=O(m,r.baseDir),R=g.word,b;if(C)b=`${L}|${U}`;else if(L.includes("/")){let A=r.ignoreCase?R:L.split("/").pop()||R;b=`${L}|${A}`}else r.ignoreCase?R.toLowerCase()===L.toLowerCase()?b=R:b=`${L}|${R}`:R!==L?b=`${L}|${R}`:b=L;se(e,s)&&b.includes("|")&&(b=b.replace(/\|/g,"\\|")),o+=`[[${b}]]`,s+=g.length;continue e}}}o+=e[s],s++}return o},I=({body:e,linkResolverContext:{filePath:t,trie:n,candidateMap:i},settings:a={minCharCount:0,namespaceResolution:!0,baseDir:void 0,ignoreDateFormats:!0}})=>{if(e.length<=(a.minCharCount??0)||(e=e.normalize("NFC"),Ue(e)))return e;let u=re(i,a.ignoreCase),r=ke(t,a.baseDir),o=c=>ae.test(c)?ye(c,n,i,r,t,a):oe(c,n,i,u,t,r,a),s="",h=0;for(let c of e.matchAll(Ce)){let l=c.index??0,d=e.slice(h,l);s+=o(d),s+=c[0],h=l+c[0].length}return s+=o(e.slice(h)),s};var W=({body:e,urlTitleMap:t})=>{if(t.size===0)return e;let n=e,i=Array.from(t.keys()).sort((a,u)=>u.length-a.length);for(let a of i){let u=t.get(a);if(!u)continue;let r=`[${u}](${a})`,o=0,s=[];for(;o<n.length;){let h=n.indexOf(a,o);if(h===-1){s.push(n.substring(o));break}s.push(n.substring(o,h));let c=!0,l=n.substring(h-2,h),d=n[h+a.length];if(l==="]("&&d===")"&&(c=!1),c){let g=n.substring(0,h);if((g.match(/(?<!\\)`/g)||[]).length%2!==0){let p=g.lastIndexOf("`");p!==-1&&!g.substring(p+1).includes("`")&&(c=!1)}}c?s.push(r):s.push(a),o=h+a.length}n=s.join("")}return n};var Se=/<title[^>]*>([^<]+)<\/title>/i,H=e=>{let t=e.match(Se);return t&&t[1]?t[1].trim():""};var Ee=/https?:\/\/[^\s<>"'`)]+/g,Ne=/[.,;!?\]}]+$/,_=(e,t)=>{let n=new Set,i,a=[],u=/^(?:```|~~~)[^\r\n]*?\r?\n([\s\S]*?)\r?\n^(?:```|~~~)$/gm,r;for(;(r=u.exec(e))!==null;)a.push({start:r.index,end:r.index+r[0].length});for(u.lastIndex=0;(i=Ee.exec(e))!==null;){let o=i[0],s=i.index,h=!1;for(let l of a)if(s>=l.start&&s<l.end){h=!0;break}if(h)continue;let c=!0;if(s>=2){let l=s+o.length;l<e.length&&e[l]===")"&&e.substring(s-2,s)==="]("&&(c=!1)}if(c&&s>=1){let l=e[s-1],d=e[s+o.length];l==="<"&&d===">"&&(c=!1)}if(c){let l=e.substring(0,s);if((l.match(/(?<!\\)`/g)||[]).length%2!==0){let g=l.lastIndexOf("`");g!==-1&&!l.substring(g+1).includes("`")&&(c=!1)}}if(c){let l=o,d=!0;if(t&&t.length>0)try{let f=new URL(o).hostname;t.some(p=>f===p||f.endsWith(`.${p}`))&&(d=!1)}catch(g){console.warn(`Failed to parse URL for domain check: ${o}`,g),d=!1}if(d){let g=o.replace(Ne,"");g.includes("://")?l=g:(l=o,console.warn(`URL cleaning potentially broke the URL: ${o} -> ${g}`))}d&&n.add(l)}}return n};function $(e,t){try{let n=new URL(e);if(!Pe(n,t.jiraURLs)||e.includes("?"))return e;let i=Ie(n);if(!i)return e;let a=$e(n,i);return Me(n,i,a)}catch{return e}}function Ie(e){let t=e.pathname.split("/").filter(Boolean);if(t[0]!=="browse"||t.length!==2)return null;let n=t[1].split("-");return n.length!==2?null:{project:n[0],issueId:n[1]}}function $e(e,t){return`${e.origin}/browse/${t.project}-${t.issueId}`}function Me(e,t,n){return`[[${e.hostname.split(".")[1]}/jira/${t.project}/${t.issueId}]] [\u{1F517}](${n})`}function Pe(e,t){return t.some(n=>{let i=n.replace(/^https?:\/\//,"").replace(/\/$/,"");return e.hostname===i})}function G(e,t){try{let n=new URL(e);if(!We(n,t.githubEnterpriseURLs))return e;let i=Fe(n);if(!i)return e;let a=Oe(n,i);return Be(i,a)}catch{return e}}function Fe(e){let t=e.pathname.split("/").filter(Boolean);if(t.length<2)return null;let[n,i,a,u]=t,r={owner:n,repository:i};return He(e)&&(r.type=a,r.id=u),r}function Oe(e,t){if(t.type&&t.id){let n=`/${t.owner}/${t.repository}/${t.type}/${t.id}`;return`${e.origin}${n}`}return`${e.origin}/${t.owner}/${t.repository}`.replace(/\/$/,"")}function Be(e,t){let u=`[[${new URL(t).hostname!=="github.com"?"ghe":"github"}/${e.owner}/${e.repository}`;return e.type&&e.id&&(u+=`/${e.type}/${e.id}`),u+=`]] [\u{1F517}](${t})`,u}function We(e,t){return e.hostname==="github.com"?!0:t.some(n=>{let i=n.replace(/^https?:\/\//,"").replace(/\/$/,"");return e.hostname===i})}function He(e){let t=e.pathname.toLowerCase();return t.includes("/pull/")||t.includes("/issues/")}var E=(e,t,n)=>{let i=/(?<!\[\[.*)(https?:\/\/[^\s\]]+)(?!.*\]\])/g;return e=e.replace(i,a=>n(a,t)),e};var w=require("obsidian"),M=class extends w.PluginSettingTab{plugin;constructor(t,n){super(t,n),this.plugin=n}display(){let{containerEl:t}=this;t.empty(),new w.Setting(t).setName("General").setHeading(),new w.Setting(t).setName("Format on save").setDesc("When enabled, the file will be automatically formatted (links replaced) when saving.").addToggle(n=>{n.setValue(this.plugin.settings.formatOnSave).onChange(async i=>{this.plugin.settings.formatOnSave=i,await this.plugin.saveData(this.plugin.settings)})}),new w.Setting(t).setName("Format on save for a current line").setDesc("When enabled, the current line will be formatted (links replaced) when saving. If you enable this, the 'Format on save' setting will be ignored for the current line.").addToggle(n=>{n.setValue(this.plugin.settings.formatOnSaveCurrentLine).onChange(async i=>{this.plugin.settings.formatOnSaveCurrentLine=i,await this.plugin.saveData(this.plugin.settings)})}),new w.Setting(t).setName("Base directory").setDesc("Enter the directory to be treated as the base directory. For example, 'pages' will allow links to be formatted without the 'pages/' prefix.").addText(n=>{n.setPlaceholder(`e.g. pages
`).setValue(this.plugin.settings.baseDir).onChange(async i=>{this.plugin.settings.baseDir=i,await this.plugin.saveData(this.plugin.settings)})}),new w.Setting(t).setName("Minimum character count").setDesc("If the content is below this character count, the links will not be replaced.").addText(n=>{n.setPlaceholder("e.g. 4").setValue(this.plugin.settings.minCharCount.toString()).onChange(async i=>{let a=parseInt(i);isNaN(a)||(this.plugin.settings.minCharCount=a,await this.plugin.saveData(this.plugin.settings))})}),new w.Setting(t).setName("Consider aliases").setDesc("When enabled, aliases will be taken into account when processing links. Note: A restart is required for changes to take effect.").addToggle(n=>{n.setValue(this.plugin.settings.considerAliases).onChange(async i=>{this.plugin.settings.considerAliases=i,await this.plugin.saveData(this.plugin.settings)})}),new w.Setting(t).setName("Automatic namespace resolution").setDesc("When enabled, the plugin will automatically resolve namespaces for shorthand links. If multiple candidates share the same shorthand, the candidate with the most common path segments relative to the current file will be selected.").addToggle(n=>{n.setValue(this.plugin.settings.namespaceResolution).onChange(async i=>{this.plugin.settings.namespaceResolution=i,await this.plugin.saveData(this.plugin.settings)})}),new w.Setting(t).setName("Ignore date formats").setDesc("When enabled, links that match date formats (e.g. 2025-02-10) will be ignored. This helps maintain compatibility with Obsidian Tasks.").addToggle(n=>{n.setValue(this.plugin.settings.ignoreDateFormats).onChange(async i=>{this.plugin.settings.ignoreDateFormats=i,await this.plugin.saveData(this.plugin.settings)})}),new w.Setting(t).setName("Ignore case").setDesc("When enabled, link matching will be case-insensitive. The original case of the text will be preserved in the link.").addToggle(n=>{n.setValue(this.plugin.settings.ignoreCase).onChange(async i=>{this.plugin.settings.ignoreCase=i,await this.plugin.saveData(this.plugin.settings)})}),new w.Setting(t).setName("URL Formatting for GitHub").setHeading(),new w.Setting(t).setName("Format GitHub URLs on save").setDesc("When enabled, GitHub URLs will be formatted when saving the file.").addToggle(n=>{n.setValue(this.plugin.settings.formatGitHubURLs).onChange(async i=>{this.plugin.settings.formatGitHubURLs=i,await this.plugin.saveData(this.plugin.settings)})}),new w.Setting(t).setName("GitHub Enterprise URLs").setDesc("Add your GitHub Enterprise URLs, one per line (e.g., github.enterprise.com)").addTextArea(n=>{n.setPlaceholder(`github.enterprise.com
github.company.com`).setValue(this.plugin.settings.githubEnterpriseURLs.join(`
`)).onChange(async i=>{let a=i.split(`
`).map(u=>u.trim()).filter(Boolean);this.plugin.settings.githubEnterpriseURLs=a,await this.plugin.saveData(this.plugin.settings)}),n.inputEl.rows=4,n.inputEl.cols=50}),new w.Setting(t).setName("URL Formatting for Jira").setHeading(),new w.Setting(t).setName("Format JIRA URLs on save").setDesc("When enabled, JIRA URLs will be formatted when saving the file.").addToggle(n=>{n.setValue(this.plugin.settings.formatJiraURLs).onChange(async i=>{this.plugin.settings.formatJiraURLs=i,await this.plugin.saveData(this.plugin.settings)})}),new w.Setting(t).setName("JIRA URLs").setDesc("Add your JIRA URLs, one per line (e.g., jira.enterprise.com)").addTextArea(n=>{n.setPlaceholder(`jira.enterprise.com
jira.company.com`).setValue(this.plugin.settings.jiraURLs.join(`
`)).onChange(async i=>{let a=i.split(`
`).map(u=>u.trim()).filter(Boolean);this.plugin.settings.jiraURLs=a,await this.plugin.saveData(this.plugin.settings)}),n.inputEl.rows=4,n.inputEl.cols=50}),new w.Setting(t).setName("URL Replacement with Title").setHeading(),new w.Setting(t).setName("Replace URL with title").setDesc("When enabled, raw URLs will be replaced with [Page Title](URL). Requires fetching the URL content.").addToggle(n=>{n.setValue(this.plugin.settings.replaceUrlWithTitle).onChange(async i=>{this.plugin.settings.replaceUrlWithTitle=i,await this.plugin.saveData(this.plugin.settings)})}),new w.Setting(t).setName("Igonre domains").setDesc("Ignore domains for replacing URLs with titles, one per line (e.g., x.com)").addTextArea(n=>{n.setPlaceholder("").setValue(this.plugin.settings.replaceUrlWithTitleIgnoreDomains.join(`
`)).onChange(async i=>{let a=i.split(`
`).map(u=>u.trim()).filter(Boolean);this.plugin.settings.replaceUrlWithTitleIgnoreDomains=a,await this.plugin.saveData(this.plugin.settings)}),n.inputEl.rows=4,n.inputEl.cols=50}),new w.Setting(t).setName("Debug").setHeading(),new w.Setting(t).setName("Show load notice").setDesc("Display a notice when markdown files are loaded.").addToggle(n=>{n.setValue(this.plugin.settings.showNotice).onChange(async i=>{this.plugin.settings.showNotice=i,await this.plugin.saveData(this.plugin.settings)})}),new w.Setting(t).setName("Debug mode").setDesc("When enabled, debug information will be logged to the console.").addToggle(n=>{n.setValue(this.plugin.settings.debug).onChange(async i=>{this.plugin.settings.debug=i,await this.plugin.saveData(this.plugin.settings)})})}};var le={formatOnSave:!1,formatOnSaveCurrentLine:!1,baseDir:"pages",showNotice:!1,minCharCount:0,considerAliases:!1,namespaceResolution:!1,ignoreDateFormats:!0,formatGitHubURLs:!0,githubEnterpriseURLs:[],formatJiraURLs:!0,jiraURLs:[],debug:!1,ignoreCase:!1,replaceUrlWithTitle:!1,replaceUrlWithTitleIgnoreDomains:[]};var P=class extends T.Plugin{settings;trie=null;candidateMap=null;originalSaveCallback;urlTitleMap=new Map;constructor(t,n){super(t,n)}async modifyLinks(){let t=this.app.workspace.getActiveFile();if(t)try{if(this.settings.formatGitHubURLs&&await this.app.vault.process(t,n=>E(n,this.settings,G)),this.settings.formatJiraURLs&&await this.app.vault.process(t,n=>E(n,this.settings,$)),this.settings.replaceUrlWithTitle){let n=await this.app.vault.read(t),{contentStart:i}=(0,T.getFrontMatterInfo)(n),a=n.slice(i),u=_(a);for(let r of u){let o=await(0,T.request)(r),s=H(o);this.urlTitleMap.set(r,s)}await this.app.vault.process(t,r=>{let{contentStart:o}=(0,T.getFrontMatterInfo)(r),s=r.slice(0,o),h=r.slice(o),c=W({body:h,urlTitleMap:this.urlTitleMap});return s+c})}await this.app.vault.process(t,n=>{if(!this.trie||!this.candidateMap)return n;this.settings.debug&&(console.log("this.trie: ",this.trie),console.log("this.candidateMap: ",this.candidateMap),console.log(new Date().toISOString(),"modifyLinks started"));let{contentStart:i}=(0,T.getFrontMatterInfo)(n),a=n.slice(0,i),u=I({body:n.slice(i),linkResolverContext:{filePath:t.path.replace(/\.md$/,""),trie:this.trie,candidateMap:this.candidateMap},settings:{minCharCount:this.settings.minCharCount,namespaceResolution:this.settings.namespaceResolution,baseDir:this.settings.baseDir,ignoreDateFormats:this.settings.ignoreDateFormats}});return this.settings.debug&&console.log(new Date().toISOString(),"modifyLinks finished"),a+u})}catch(n){console.error(n)}}async modifyLinksCurrentLine(){let t=this.app.workspace.getActiveFile();if(!t)return;let n=this.app.workspace.activeEditor;if(!n)return;let i=n.editor;if(!i)return;let a=i.getCursor().line,u=i.getLine(a),r=u;if(!this.trie||!this.candidateMap)return;if(r=I({body:r,linkResolverContext:{filePath:t.path.replace(/\.md$/,""),trie:this.trie,candidateMap:this.candidateMap},settings:{minCharCount:this.settings.minCharCount,namespaceResolution:this.settings.namespaceResolution,baseDir:this.settings.baseDir,ignoreDateFormats:this.settings.ignoreDateFormats}}),this.settings.formatGitHubURLs&&(r=E(i.getLine(a),this.settings,G)),this.settings.formatJiraURLs&&(r=E(i.getLine(a),this.settings,$)),this.settings.replaceUrlWithTitle){let s=await this.app.vault.read(t),{contentStart:h}=(0,T.getFrontMatterInfo)(s),c=s.slice(h),l=_(c);for(let d of l){let g=await(0,T.request)(d),f=H(g);this.urlTitleMap.set(d,f)}r=W({body:r,urlTitleMap:this.urlTitleMap})}let o=i.getCursor();i.replaceRange(r,{line:a,ch:0},{line:a,ch:u.length}),i.setCursor({line:o.line,ch:o.ch})}async formatOnSave(){this.settings.formatOnSave&&(this.settings.formatOnSaveCurrentLine?await this.modifyLinksCurrentLine():await this.modifyLinks())}async mofifyLinksSelection(){let t=this.app.workspace.getActiveFile();if(!t)return;let n=this.app.workspace.activeEditor;if(!n)return;let i=n.editor;if(!i)return;let a=i.getSelection();if(!this.trie||!this.candidateMap)return;let u=I({body:a,linkResolverContext:{filePath:t.path.replace(/\.md$/,""),trie:this.trie,candidateMap:this.candidateMap},settings:{minCharCount:this.settings.minCharCount,namespaceResolution:this.settings.namespaceResolution,baseDir:this.settings.baseDir,ignoreDateFormats:this.settings.ignoreDateFormats}});i.replaceSelection(u)}async onload(){await this.loadSettings(),this.addSettingTab(new M(this.app,this));let t=()=>{let o=this.app.vault.getMarkdownFiles().map(c=>{let l=c.path.replace(/\.md$/,""),g=this.app.metadataCache.getFileCache(c)?.frontmatter?.["automatic-linker-restrict-namespace"]===!0,f=(()=>{if(this.settings.considerAliases){let p=this.app.metadataCache.getFileCache(c)?.frontmatter;return(0,T.parseFrontMatterAliases)(p)}else return null})();return{path:l,aliases:f,restrictNamespace:g}});o.sort((c,l)=>l.path.length-c.path.length);let{candidateMap:s,trie:h}=F(o,this.settings.baseDir);this.candidateMap=s,this.trie=h,this.settings.showNotice&&new T.Notice(`Automatic Linker: Loaded all markdown files. (${o.length} files)`)};this.app.workspace.onLayoutReady(()=>{t(),this.settings.debug&&console.log("Automatic Linker: Built all markdown files."),this.registerEvent(this.app.vault.on("delete",()=>t())),this.registerEvent(this.app.vault.on("create",()=>t())),this.registerEvent(this.app.vault.on("rename",()=>t()))}),this.addCommand({id:"link-current-file",name:"Link current file",editorCallback:async()=>{try{await this.modifyLinks()}catch(r){console.error(r)}}}),this.addCommand({id:"rebuild-all-files",name:"rebuild all files",editorCallback:async()=>{try{t(),this.settings.debug&&console.log("Automatic Linker: Built all markdown files.")}catch(r){console.error(r)}}}),this.addCommand({id:"link-selection",name:"Link selection",editorCallback:async()=>{try{await this.mofifyLinksSelection()}catch(r){console.error(r)}}}),this.addCommand({id:"copy-file-content-without-links",name:"Copy file content without links",editorCallback:async()=>{let r=this.app.workspace.getActiveFile();if(!r)return;let o=await this.app.vault.read(r),{contentStart:s}=(0,T.getFrontMatterInfo)(o),h=o.slice(s),c=Q(h);navigator.clipboard.writeText(c)}});let n=new ce.default,i=(r,o)=>n.acquire(r,o),a=this.app?.commands?.commands?.["editor:save-file"],u=a?.checkCallback;if(typeof u=="function"){this.originalSaveCallback=u;let r=z(async()=>{if(this.settings.formatOnSave)try{await this.formatOnSave()}catch(o){console.error(o)}},300,{leading:!0});a.checkCallback=async()=>{i("save",async()=>{await r()}),i("save",async()=>{await u?.()})}}}async onunload(){let t=this.app?.commands?.commands?.["editor:save-file"];t&&this.originalSaveCallback&&(t.checkCallback=this.originalSaveCallback)}async loadSettings(){this.settings=Object.assign({},le,await this.loadData())}async saveSettings(){await this.saveData(this.settings)}};

/* nosourcemap */